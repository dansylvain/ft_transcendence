{% load static %}
<div class="container-fluid">
	<!-- Page Heading -->
	<h1 data-translate="SETUP 2FA" class="h3 mb-2 text-gray-800">SETUP 2FA for {{ username }}</h1>
	<p class="mb-4">Two-factor authentication adds an extra layer of security to your account by requiring more than just a password to sign in.</p>

	<div class="row">
		<!-- ! QR CODE  -->
		<div class="col-lg-8 mb-4">
			<div class="card shadow mb-4">
				<div class="card-header py-3">
					<h6 class="m-0 font-weight-bold text-primary">Step 1: Scan QR Code</h6>
				</div>
				<div class="card-body text-center">
					<p>Scan the QR code with your authenticator app (like Google Authenticator, Authy, or Microsoft Authenticator)</p>
					{% if qr_code %}
					<img src="{{ qr_code }}" alt="QR Code" class="img-fluid" style="max-width: 250px;">
					{% else %}
					<div class="alert alert-danger">Error generating QR code</div>
					{% endif %}
					<p class="mt-3 text-xs">Or manually enter this key in your app: <strong>{{ secret }}</strong></p>
				</div>
			</div>
		</div>
        
		<!-- ! VERIFY CODE FORM -->
		<div class="col-lg-4 mb-4">
			<div class="card shadow mb-4">
				<div class="card-header py-3">
					<h6 class="m-0 font-weight-bold text-primary">Step 2: Verify Code</h6>
				</div>
				<div class="card-body">
					<form hx-post="/user/verify-2fa/" 
                          hx-target="#main_div" 
                          hx-headers='{"HX-Request": "true", "X-CSRFToken": "{{ csrf_token }}"}'>
						{% csrf_token %}
                        <div class="form-group">
							<label>Enter the code generated by your authenticator app:</label>
							<input type="number" name="token" maxlength="6" class="form-control form-control-user" 
								placeholder="Enter 6-digit code" required>
						</div>
						<div class="form-group mt-4">
							<button type="submit" class="btn btn-primary btn-user btn-block">
								Verify and Activate
							</button>
                            <a href="/user/profile/" class="btn btn-secondary btn-user btn-block mt-2" 
                               hx-get="/user/profile/" 
                               hx-target="#main_div" 
                               hx-headers='{"HX-Request": "true"}'>
                                Cancel
                            </a>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>