{% load static %}
<script src="https://kit.fontawesome.com/3dd39fb56b.js" crossorigin="anonymous"></script>
<script src="{% static 'static_files/translations.js' %}"></script>
<script src="https://unpkg.com/htmx.org@1.9.6"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
<script src="{% static 'static_files/vendor/jquery/jquery.min.js' %}"></script>
<script src="{% static 'static_files/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'static_files/vendor/jquery-easing/jquery.easing.min.js' %}"></script>
<script src="{% static 'static_files/js/sb-admin-2.min.js' %}"></script>
<script>
    window.addEventListener("beforeunload", () => {
        console.log("URL sauvegard√©e avec history.state et sessionStorage");
        
        let currentURL = window.location.href;

        // Sauvegarde dans history.state
        history.replaceState({ lastVisitedPage: currentURL }, "");

        // Sauvegarde dans sessionStorage
        sessionStorage.setItem("lastVisitedPage", currentURL);
    });

    function updateLayout() {
        const url = window.location.href;
        if (url.includes('/home')) {
            toggleSidebar(false);
        } else {
            toggleSidebar(true);
        }
    }

    updateLayout();

    function toggleSidebar(show) {
        console.log("toggleSidebar called");
        const sidebar = document.querySelector('#accordionSidebar');
        if (!sidebar)
            return;
        if (show) {
            sidebar.classList.remove('d-none');
        } else {
            sidebar.classList.add('d-none');
        }
    }
</script>