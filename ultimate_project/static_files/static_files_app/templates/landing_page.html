{% load static %}

<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Auth Page</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://unpkg.com/htmx.org@1.9.6"></script>

	<style>
		.form-container {
			display: none;
		}

		.form-container.active {
			display: block;
		}

		.oauth-btn {
			width: 100%;
			margin-bottom: 10px;
			padding: 10px;
			font-size: 1.1rem;
		}

		.top-right-btn {
			position: absolute;
			top: 20px;
			right: 20px;
		}
	</style>
</head>

<body>
	<div class="container text-center min-vw-100 vh-100">
		<div class="row">
			<div class="w-50 min-vw-50 vh-100 col bg-secondary-subtle d-flex align-items-center justify-content-center">
				<img class="align-self-start w-25 h-25" src="{% static 'static_files/pong-champ.svg' %}">
				<img class="h-50" src="{% static 'static_files/retro_pong.webp' %}">
			</div>

			<div class="d-flex flex-column w-50 vh-100 col position-relative">

				<!-- ðŸ”˜ Top Right Toggle Button -->
				<button id="toggle-btn" class="btn btn-outline-primary top-right-btn" onclick="toggleForm()">
					Sign Up
				</button>

				<!-- Top half with forms -->
				<div class="d-flex flex-column h-50 align-items-center justify-content-center">

					<!-- Login Form -->
					<div id="login-form" class="form-container active w-75">
						<h2 class="mb-4">Log In</h2>
						<div id="login-message"></div>
						<form class="d-flex flex-column align-items-start w-100" method="post" action="/nope2">
							{% csrf_token %}
							<label>Username or Email</label>
							<input class="mb-3 form-control" type="text" name="username" placeholder="Username or Email"
								required>
							<label>Password</label>
							<input class="mb-3 form-control" type="password" name="password" placeholder="Password"
								required>
							<button class="mb-3 btn btn-primary" type="submit">Sign In</button>
						</form>
					</div>

					<!-- Sign Up Form -->
					<div id="signup-form" class="form-container w-75">
						<h2 class="mb-4">Sign Up</h2>
						<div id="signup-message"></div>
						<form class="d-flex flex-column align-items-start w-100" method="post" action="/nope">
							{% csrf_token %}
							<label>Username</label>
							<input class="mb-3 form-control" type="text" name="username" placeholder="Username"
								required>
							<label>Email</label>
							<input class="mb-3 form-control" type="email" name="email" placeholder="Email" required>
							<label>Password</label>
							<input class="mb-3 form-control" type="password" name="password" placeholder="Password"
							required>
							<label>Confirm Password</label>
							<input class="mb-3 form-control" type="password" name="confirm_password"
							placeholder="Confirm Password" required>
							<div class="form-check form-switch">
								<input class="form-check-input" type="checkbox" role="switch"
									id="flexSwitchCheckDefault">
								<label class="form-check-label" for="flexSwitchCheckDefault">ENABLE 2FA</label>
							</div>
							<button class="mb-3 btn btn-primary" type="submit">Create Account</button>
						</form>
					</div>

				</div>

				<!-- Bottom half with OAuth buttons -->
				<div class="d-flex flex-column h-50 align-items-center justify-content-center">
					<h3 class="mb-4">Or</h3>
					<div class="w-75">
						<button class="oauth-btn btn btn-primary" onclick="window.location.href='/auth/42/'">
							<i class="bi bi-code-slash me-2"></i> Continue with 42
						</button>
						<button class="oauth-btn btn btn-danger" onclick="window.location.href='/auth/google/'">
							<i class="bi bi-google me-2"></i> Continue with Google
						</button>
						<button class="oauth-btn btn btn-dark" onclick="window.location.href='/auth/github/'">
							<i class="bi bi-github me-2"></i> Continue with GitHub
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		function toggleForm() {
			try {
				// Get references
				const loginForm = document.getElementById('login-form');
				const signupForm = document.getElementById('signup-form');
				const toggleBtn = document.getElementById('toggle-btn');

				// Toggle visibility
				if (loginForm.classList.contains('active')) {
					loginForm.classList.remove('active');
					signupForm.classList.add('active');
					toggleBtn.textContent = 'Log In';
				} else {
					signupForm.classList.remove('active');
					loginForm.classList.add('active');
					toggleBtn.textContent = 'Sign Up';
				}
			} catch (error) {
				console.error("Error toggling form:", error);
			}
		}

		// Ensure login form is active on load
		document.addEventListener('DOMContentLoaded', function () {
			document.getElementById('login-form').classList.add('active');
		});
	</script>
</body>

</html>